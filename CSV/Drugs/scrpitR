library(readxl)

drugs <-readxl::read_excel("C:/Users/joelm/OneDrive/Escritorio/Proy/Drugs/drugInvolvementAlabama/Offenses_Involving_Offender's_Suspected_Use_Drugs_Narcotics_and_Alcohol_by_Offense_Category_2022.xlsx")
head(drugs)
drugs <- as.data.frame(drugs)
#AÃ±adir columna Estado
drugs$estado <- "Alabama"

# Cambiar nom les columnes
colnames(drugs) <- c("Offense category", "Total offenses", "Drugs/Narcotics", "Percentage of Offense category", "Alcohol","Percentage of Offense Category","Estado")


# Eliminar les primeres y ultima fila 
drugs <- drugs[-c(1:4), ]
num_filas <- nrow(drugs)
drugs <- drugs[-num_filas, ]



# ALASKA
alaska <-readxl::read_excel("C:/Users/joelm/OneDrive/Escritorio/Proy/Drugs/drugInvolvementAlaska/Offenses_Involving_Offender's_Suspected_Use_Drugs_Narcotics_and_Alcohol_by_Offense_Category_2022.xlsx")
head(alaska)
alaska <- as.data.frame(alaska)

alaska <- alaska[-c(1:4), ]
num_filas <- nrow(alaska)
alaska <- alaska[-num_filas, ]
alaska$estado <- "Alaska"
colnames(alaska) <- colnames(drugs)
drugs <- rbind(drugs, alaska)

# ARIZONA
arizona <-readxl::read_excel("C:/Users/joelm/OneDrive/Escritorio/Proy/Drugs/drugInvolvementArizona/Offenses_Involving_Offender's_Suspected_Use_Drugs_Narcotics_and_Alcohol_by_Offense_Category_2022.xlsx")
head(arizona)
arizona <- as.data.frame(arizona)

arizona <- arizona[-c(1:4), ]
num_filas <- nrow(arizona)
arizona <- arizona[-num_filas, ]
arizona$estado <- "Arizona"

colnames(arizona) <- colnames(drugs)
drugs <- rbind(drugs, arizona)

# ARKANSAS
arkansas <-readxl::read_excel("C:/Users/joelm/OneDrive/Escritorio/Proy/Drugs/drugInvolvementArkansas/Offenses_Involving_Offender's_Suspected_Use_Drugs_Narcotics_and_Alcohol_by_Offense_Category_2022.xlsx")
arkansas <- as.data.frame(arkansas)

arkansas <- arkansas[-c(1:4), ]
num_filas <- nrow(arkansas)
arkansas <- arkansas[-num_filas, ]
arkansas$estado <- "Arkansas"

colnames(arkansas) <-colnames(drugs)
drugs <- rbind(drugs, arkansas)

# CALIFORNIA
california <-readxl::read_excel("C:/Users/joelm/OneDrive/Escritorio/Proy/Drugs/drugInvolvementCalifornia/Offenses_Involving_Offender's_Suspected_Use_Drugs_Narcotics_and_Alcohol_by_Offense_Category_2022.xlsx")
california <- as.data.frame(california)

california <- california[-c(1:4), ]
num_filas <- nrow(california)
california <- california[-num_filas, ]
california$estado <- "California"

colnames(california) <-colnames(drugs)
drugs <- rbind(drugs, california)

# COLORADO
colorado <-readxl::read_excel("C:/Users/joelm/OneDrive/Escritorio/Proy/Drugs/drugInvolvementColorado/Offenses_Involving_Offender's_Suspected_Use_Drugs_Narcotics_and_Alcohol_by_Offense_Category_2022.xlsx")
colorado <- as.data.frame(colorado)

colorado <- colorado[-c(1:4), ]
num_filas <- nrow(colorado)
colorado <- colorado[-num_filas, ]
colorado$estado <- "Colorado"

colnames(colorado) <-colnames(drugs)
drugs <- rbind(drugs, colorado)

# COLUMBIA
columbia <-readxl::read_excel("C:/Users/joelm/OneDrive/Escritorio/Proy/Drugs/drugInvolvementColumbia/Offenses_Involving_Offender's_Suspected_Use_Drugs_Narcotics_and_Alcohol_by_Offense_Category_2022.xlsx")
columbia <- as.data.frame(columbia)

columbia <- columbia[-c(1:4), ]
num_filas <- nrow(columbia)
columbia <- columbia[-num_filas, ]
columbia$estado <- "Columbia"

colnames(columbia) <-colnames(drugs)
drugs <- rbind(drugs, columbia)

# CONECTICUT
connecticut <-readxl::read_excel("C:/Users/joelm/OneDrive/Escritorio/Proy/Drugs/drugInvolvementConeccticut/Offenses_Involving_Offender's_Suspected_Use_Drugs_Narcotics_and_Alcohol_by_Offense_Category_2022.xlsx")
connecticut <- as.data.frame(connecticut)

connecticut <- connecticut[-c(1:4), ]
num_filas <- nrow(connecticut)
connecticut <- connecticut[-num_filas, ]
connecticut$estado <- "Connecticut"

colnames(connecticut) <- colnames(drugs)
drugs <- rbind(drugs, connecticut)

# DELAWARE
delaware <-readxl::read_excel("C:/Users/joelm/OneDrive/Escritorio/Proy/Drugs/drugInvolvementDelaware/Offenses_Involving_Offender's_Suspected_Use_Drugs_Narcotics_and_Alcohol_by_Offense_Category_2022.xlsx")
delaware <- as.data.frame(delaware)

delaware <- delaware[-c(1:4), ]
num_filas <- nrow(delaware)
delaware <- delaware[-num_filas, ]
delaware$estado <- "Delaware"

colnames(delaware) <- colnames(drugs)
drugs <- rbind(drugs, delaware)

# FLORIDA
florida <- readxl::read_excel("C:/Users/joelm/OneDrive/Escritorio/Proy/Drugs/drugInvolvementFlorida/Offenses_Involving_Offender's_Suspected_Use_Drugs_Narcotics_and_Alcohol_by_Offense_Category_2022.xlsx")
florida <- as.data.frame(florida)

florida <- florida[-c(1:4), ]
num_filas <- nrow(florida)
florida <- florida[-num_filas, ]
florida$estado <- "Florida"

colnames(florida) <- colnames(drugs)
drugs <- rbind(drugs, florida)

# GEORGIA
georgia <- readxl::read_excel("C:/Users/joelm/OneDrive/Escritorio/Proy/Drugs/drugInvolvementGeorgia/Offenses_Involving_Offender's_Suspected_Use_Drugs_Narcotics_and_Alcohol_by_Offense_Category_2022.xlsx")
georgia <- as.data.frame(georgia)

georgia <- georgia[-c(1:4), ]
num_filas <- nrow(georgia)
georgia <- georgia[-num_filas, ]
georgia$estado <- "Georgia"

colnames(georgia) <- colnames(drugs)
drugs <- rbind(drugs, georgia)

# HAWAII
hawaii <- readxl::read_excel("C:/Users/joelm/OneDrive/Escritorio/Proy/Drugs/drugInvolvementHawaii/Offenses_Involving_Offender's_Suspected_Use_Drugs_Narcotics_and_Alcohol_by_Offense_Category_2022.xlsx")
hawaii <- as.data.frame(hawaii)

hawaii <- hawaii[-c(1:4), ]
num_filas <- nrow(hawaii)
hawaii <- hawaii[-num_filas, ]
hawaii$estado <- "Hawaii"

colnames(hawaii) <- colnames(drugs)
drugs <- rbind(drugs, hawaii)

# IDAHO
idaho <- readxl::read_excel("C:/Users/joelm/OneDrive/Escritorio/Proy/Drugs/drugInvolvementIdaho/Offenses_Involving_Offender's_Suspected_Use_Drugs_Narcotics_and_Alcohol_by_Offense_Category_2022.xlsx")
idaho <- as.data.frame(idaho)

idaho <- idaho[-c(1:4), ]
num_filas <- nrow(idaho)
idaho <- idaho[-num_filas, ]
idaho$estado <- "Idaho"

colnames(idaho) <- colnames(drugs)
drugs <- rbind(drugs, idaho)

# ILLINOIS
illinois <- readxl::read_excel("C:/Users/joelm/OneDrive/Escritorio/Proy/Drugs/drugInvolvementIllinois/Offenses_Involving_Offender's_Suspected_Use_Drugs_Narcotics_and_Alcohol_by_Offense_Category_2022.xlsx")
illinois <- as.data.frame(illinois)

illinois <- illinois[-c(1:4), ]
num_filas <- nrow(illinois)
illinois <- illinois[-num_filas, ]
illinois$estado <- "Illinois"

colnames(illinois) <- colnames(drugs)
drugs <- rbind(drugs, illinois)

# IDAHO
idaho <- readxl::read_excel("C:/Users/joelm/OneDrive/Escritorio/Proy/Drugs/drugInvolvementIdaho/Offenses_Involving_Offender's_Suspected_Use_Drugs_Narcotics_and_Alcohol_by_Offense_Category_2022.xlsx")
idaho <- as.data.frame(idaho)

idaho <- idaho[-c(1:4), ]
num_filas <- nrow(idaho)
idaho <- idaho[-num_filas, ]
idaho$estado <- "Idaho"

colnames(idaho) <- colnames(drugs)
drugs <- rbind(drugs, idaho)

# IOWA
iowa <- readxl::read_excel("C:/Users/joelm/OneDrive/Escritorio/Proy/Drugs/drugInvolvementIowa/Offenses_Involving_Offender's_Suspected_Use_Drugs_Narcotics_and_Alcohol_by_Offense_Category_2022.xlsx")
iowa <- as.data.frame(iowa)

iowa <- iowa[-c(1:4), ]
num_filas <- nrow(iowa)
iowa <- iowa[-num_filas, ]
iowa$estado <- "Iowa"

colnames(iowa) <- colnames(drugs)
drugs <- rbind(drugs, iowa)

# KANSAS
kansas <- readxl::read_excel("C:/Users/joelm/OneDrive/Escritorio/Proy/Drugs/drugInvolvementKansas/Offenses_Involving_Offender's_Suspected_Use_Drugs_Narcotics_and_Alcohol_by_Offense_Category_2022.xlsx")
kansas <- as.data.frame(kansas)

kansas <- kansas[-c(1:4), ]
num_filas <- nrow(kansas)
kansas <- kansas[-num_filas, ]
kansas$estado <- "Kansas"

colnames(kansas) <- colnames(drugs)
drugs <- rbind(drugs, kansas)


# KENTUCKY
kentucky <- readxl::read_excel("C:/Users/joelm/OneDrive/Escritorio/Proy/Drugs/drugInvolvementKentucky/Offenses_Involving_Offender's_Suspected_Use_Drugs_Narcotics_and_Alcohol_by_Offense_Category_2022.xlsx")
kentucky <- as.data.frame(kentucky)

kentucky <- kentucky[-c(1:4), ]
num_filas <- nrow(kentucky)
kentucky <- kentucky[-num_filas, ]
kentucky$estado <- "Kentucky"

colnames(kentucky) <- colnames(drugs)
drugs <- rbind(drugs, kentucky)


# LOUISIANA
louisiana <- readxl::read_excel("C:/Users/joelm/OneDrive/Escritorio/Proy/Drugs/drugInvolvementLouisiana/Offenses_Involving_Offender's_Suspected_Use_Drugs_Narcotics_and_Alcohol_by_Offense_Category_2022.xlsx")
louisiana <- as.data.frame(louisiana)

louisiana <- louisiana[-c(1:4), ]
num_filas <- nrow(louisiana)
louisiana <- louisiana[-num_filas, ]
louisiana$estado <- "Louisiana"

colnames(louisiana) <- colnames(drugs)
drugs <- rbind(drugs, louisiana)

# MAINE
maine <- readxl::read_excel("C:/Users/joelm/OneDrive/Escritorio/Proy/Drugs/drugInvolvementMaine/Offenses_Involving_Offender's_Suspected_Use_Drugs_Narcotics_and_Alcohol_by_Offense_Category_2022.xlsx")
maine <- as.data.frame(maine)

maine <- maine[-c(1:4), ]
num_filas <- nrow(maine)
maine <- maine[-num_filas, ]
maine$estado <- "Maine"

colnames(maine) <- colnames(drugs)
drugs <- rbind(drugs, maine)

# Maryland
maryland <- readxl::read_excel("C:/Users/joelm/OneDrive/Escritorio/Proy/Drugs/drugInvolvementMaryland/Offenses_Involving_Offender's_Suspected_Use_Drugs_Narcotics_and_Alcohol_by_Offense_Category_2022.xlsx")
maryland <- as.data.frame(maryland)

maryland <- maryland[-c(1:4), ]
num_filas <- nrow(maryland)
maryland <- maryland[-num_filas, ]
maryland$estado <- "Maryland"

colnames(maryland) <- colnames(drugs)
drugs <- rbind(drugs, maryland)


# Massachusetts
massachusetts <- readxl::read_excel("C:/Users/joelm/OneDrive/Escritorio/Proy/Drugs/drugInvolvementMassachusetts/Offenses_Involving_Offender's_Suspected_Use_Drugs_Narcotics_and_Alcohol_by_Offense_Category_2022.xlsx")
massachusetts <- as.data.frame(massachusetts)

massachusetts <- massachusetts[-c(1:4), ]
num_filas <- nrow(massachusetts)
massachusetts <- massachusetts[-num_filas, ]
massachusetts$estado <- "Massachusetts"

colnames(massachusetts) <- colnames(drugs)
drugs <- rbind(drugs, massachusetts)


# Michigan
michigan <- readxl::read_excel("C:/Users/joelm/OneDrive/Escritorio/Proy/Drugs/drugInvolvementMichigan/Offenses_Involving_Offender's_Suspected_Use_Drugs_Narcotics_and_Alcohol_by_Offense_Category_2022.xlsx")
michigan <- as.data.frame(michigan)

michigan <- michigan[-c(1:4), ]
num_filas <- nrow(michigan)
michigan <- michigan[-num_filas, ]
michigan$estado <- "Michigan"

colnames(michigan) <- colnames(drugs)
drugs <- rbind(drugs, michigan)


# Minnesota
minnesota <- readxl::read_excel("C:/Users/joelm/OneDrive/Escritorio/Proy/Drugs/drugInvolvementMinnesota/Offenses_Involving_Offender's_Suspected_Use_Drugs_Narcotics_and_Alcohol_by_Offense_Category_2022.xlsx")
minnesota <- as.data.frame(minnesota)

minnesota <- minnesota[-c(1:4), ]
num_filas <- nrow(minnesota)
minnesota <- minnesota[-num_filas, ]
minnesota$estado <- "Minnesota"

colnames(minnesota) <- colnames(drugs)
drugs <- rbind(drugs, minnesota)


# Mississippi
mississippi <- readxl::read_excel("C:/Users/joelm/OneDrive/Escritorio/Proy/Drugs/drugInvolvementMississippi/Offenses_Involving_Offender's_Suspected_Use_Drugs_Narcotics_and_Alcohol_by_Offense_Category_2022.xlsx")
mississippi <- as.data.frame(mississippi)

mississippi <- mississippi[-c(1:4), ]
num_filas <- nrow(mississippi)
mississippi <- mississippi[-num_filas, ]
mississippi$estado <- "Mississippi"

colnames(mississippi) <- colnames(drugs)
drugs <- rbind(drugs, mississippi)


# Missouri
missouri <- readxl::read_excel("C:/Users/joelm/OneDrive/Escritorio/Proy/Drugs/drugInvolvementMissouri/Offenses_Involving_Offender's_Suspected_Use_Drugs_Narcotics_and_Alcohol_by_Offense_Category_2022.xlsx")
missouri <- as.data.frame(missouri)

missouri <- missouri[-c(1:4), ]
num_filas <- nrow(missouri)
missouri <- missouri[-num_filas, ]
missouri$estado <- "Missouri"

colnames(missouri) <- colnames(drugs)
drugs <- rbind(drugs, missouri)


# Montana
montana <- readxl::read_excel("C:/Users/joelm/OneDrive/Escritorio/Proy/Drugs/drugInvolvementMontana/Offenses_Involving_Offender's_Suspected_Use_Drugs_Narcotics_and_Alcohol_by_Offense_Category_2022.xlsx")
montana <- as.data.frame(montana)

montana <- montana[-c(1:4), ]
num_filas <- nrow(montana)
montana <- montana[-num_filas, ]
montana$estado <- "Montana"

colnames(montana) <- colnames(drugs)
drugs <- rbind(drugs, montana)


# Nebraska
nebraska <- readxl::read_excel("C:/Users/joelm/OneDrive/Escritorio/Proy/Drugs/drugInvolvementNebraska/Offenses_Involving_Offender's_Suspected_Use_Drugs_Narcotics_and_Alcohol_by_Offense_Category_2022.xlsx")
nebraska <- as.data.frame(nebraska)

nebraska <- nebraska[-c(1:4), ]
num_filas <- nrow(nebraska)
nebraska <- nebraska[-num_filas, ]
nebraska$estado <- "Nebraska"

colnames(nebraska) <- colnames(drugs)
drugs <- rbind(drugs, nebraska)


# Nevada
nevada <- readxl::read_excel("C:/Users/joelm/OneDrive/Escritorio/Proy/Drugs/drugInvolvementNevada/Offenses_Involving_Offender's_Suspected_Use_Drugs_Narcotics_and_Alcohol_by_Offense_Category_2022.xlsx")
nevada <- as.data.frame(nevada)

nevada <- nevada[-c(1:4), ]
num_filas <- nrow(nevada)
nevada <- nevada[-num_filas, ]
nevada$estado <- "Nevada"

colnames(nevada) <- colnames(drugs)
drugs <- rbind(drugs, nevada)


# New_Hampshire
new_hampshire <- readxl::read_excel("C:/Users/joelm/OneDrive/Escritorio/Proy/Drugs/drugInvolvementNew Hampshire/Offenses_Involving_Offender's_Suspected_Use_Drugs_Narcotics_and_Alcohol_by_Offense_Category_2022.xlsx")
new_hampshire <- as.data.frame(new_hampshire)

new_hampshire <- new_hampshire[-c(1:4), ]
num_filas <- nrow(new_hampshire)
new_hampshire <- new_hampshire[-num_filas, ]
new_hampshire$estado <- "New Hampshire"

colnames(new_hampshire) <- colnames(drugs)
drugs <- rbind(drugs, new_hampshire)


# New_Jersey
new_jersey <- readxl::read_excel("C:/Users/joelm/OneDrive/Escritorio/Proy/Drugs/drugInvolvementNew Jersey/Offenses_Involving_Offender's_Suspected_Use_Drugs_Narcotics_and_Alcohol_by_Offense_Category_2022.xlsx")
new_jersey <- as.data.frame(new_jersey)

new_jersey <- new_jersey[-c(1:4), ]
num_filas <- nrow(new_jersey)
new_jersey <- new_jersey[-num_filas, ]
new_jersey$estado <- "New Jersey"

colnames(new_jersey) <- colnames(drugs)
drugs <- rbind(drugs, new_jersey)


# New_Mexico
new_mexico <- readxl::read_excel("C:/Users/joelm/OneDrive/Escritorio/Proy/Drugs/drugInvolvementNew Mexico/Offenses_Involving_Offender's_Suspected_Use_Drugs_Narcotics_and_Alcohol_by_Offense_Category_2022.xlsx")
new_mexico <- as.data.frame(new_mexico)

new_mexico <- new_mexico[-c(1:4), ]
num_filas <- nrow(new_mexico)
new_mexico <- new_mexico[-num_filas, ]
new_mexico$estado <- "New Mexico"

colnames(new_mexico) <- colnames(drugs)
drugs <- rbind(drugs, new_mexico)


# New_York
new_york <- readxl::read_excel("C:/Users/joelm/OneDrive/Escritorio/Proy/Drugs/drugInvolvementNew York/Offenses_Involving_Offender's_Suspected_Use_Drugs_Narcotics_and_Alcohol_by_Offense_Category_2022.xlsx")
new_york <- as.data.frame(new_york)

new_york <- new_york[-c(1:4), ]
num_filas <- nrow(new_york)
new_york <- new_york[-num_filas, ]
new_york$estado <- "New York"

colnames(new_york) <- colnames(drugs)
drugs <- rbind(drugs, new_york)


# North_Carolina
north_carolina <- readxl::read_excel("C:/Users/joelm/OneDrive/Escritorio/Proy/Drugs/drugInvolvementNorth Carolina/Offenses_Involving_Offender's_Suspected_Use_Drugs_Narcotics_and_Alcohol_by_Offense_Category_2022.xlsx")
north_carolina <- as.data.frame(north_carolina)

north_carolina <- north_carolina[-c(1:4), ]
num_filas <- nrow(north_carolina)
north_carolina <- north_carolina[-num_filas, ]
north_carolina$estado <- "North Carolina"

colnames(north_carolina) <- colnames(drugs)
drugs <- rbind(drugs, north_carolina)


# North_Dakota
north_dakota <- readxl::read_excel("C:/Users/joelm/OneDrive/Escritorio/Proy/Drugs/drugInvolvementNorth Dakota/Offenses_Involving_Offender's_Suspected_Use_Drugs_Narcotics_and_Alcohol_by_Offense_Category_2022.xlsx")
north_dakota <- as.data.frame(north_dakota)

north_dakota <- north_dakota[-c(1:4), ]
num_filas <- nrow(north_dakota)
north_dakota <- north_dakota[-num_filas, ]
north_dakota$estado <- "North Dakota"

colnames(north_dakota) <- colnames(drugs)
drugs <- rbind(drugs, north_dakota)


# Ohio
ohio <- readxl::read_excel("C:/Users/joelm/OneDrive/Escritorio/Proy/Drugs/drugInvolvementOhio/Offenses_Involving_Offender's_Suspected_Use_Drugs_Narcotics_and_Alcohol_by_Offense_Category_2022.xlsx")
ohio <- as.data.frame(ohio)

ohio <- ohio[-c(1:4), ]
num_filas <- nrow(ohio)
ohio <- ohio[-num_filas, ]
ohio$estado <- "Ohio"

colnames(ohio) <- colnames(drugs)
drugs <- rbind(drugs, ohio)


# Oklahoma
oklahoma <- readxl::read_excel("C:/Users/joelm/OneDrive/Escritorio/Proy/Drugs/drugInvolvementOklahoma/Offenses_Involving_Offender's_Suspected_Use_Drugs_Narcotics_and_Alcohol_by_Offense_Category_2022.xlsx")
oklahoma <- as.data.frame(oklahoma)

oklahoma <- oklahoma[-c(1:4), ]
num_filas <- nrow(oklahoma)
oklahoma <- oklahoma[-num_filas, ]
oklahoma$estado <- "Oklahoma"

colnames(oklahoma) <- colnames(drugs)
drugs <- rbind(drugs, oklahoma)


# Oregon
oregon <- readxl::read_excel("C:/Users/joelm/OneDrive/Escritorio/Proy/Drugs/drugInvolvementOregon/Offenses_Involving_Offender's_Suspected_Use_Drugs_Narcotics_and_Alcohol_by_Offense_Category_2022.xlsx")
oregon <- as.data.frame(oregon)

oregon <- oregon[-c(1:4), ]
num_filas <- nrow(oregon)
oregon <- oregon[-num_filas, ]
oregon$estado <- "Oregon"

colnames(oregon) <- colnames(drugs)
drugs <- rbind(drugs, oregon)


# Pennsylvania
pennsylvania <- readxl::read_excel("C:/Users/joelm/OneDrive/Escritorio/Proy/Drugs/drugInvolvementPennsylvania/Offenses_Involving_Offender's_Suspected_Use_Drugs_Narcotics_and_Alcohol_by_Offense_Category_2022.xlsx")
pennsylvania <- as.data.frame(pennsylvania)

pennsylvania <- pennsylvania[-c(1:4), ]
num_filas <- nrow(pennsylvania)
pennsylvania <- pennsylvania[-num_filas, ]
pennsylvania$estado <- "Pennsylvania"

colnames(pennsylvania) <- colnames(drugs)
drugs <- rbind(drugs, pennsylvania)


# Rhode_Island
rhode_island <- readxl::read_excel("C:/Users/joelm/OneDrive/Escritorio/Proy/Drugs/drugInvolvementRhode Island/Offenses_Involving_Offender's_Suspected_Use_Drugs_Narcotics_and_Alcohol_by_Offense_Category_2022.xlsx")
rhode_island <- as.data.frame(rhode_island)

rhode_island <- rhode_island[-c(1:4), ]
num_filas <- nrow(rhode_island)
rhode_island <- rhode_island[-num_filas, ]
rhode_island$estado <- "Rhode Island"

colnames(rhode_island) <- colnames(drugs)
drugs <- rbind(drugs, rhode_island)


# South_Carolina
south_carolina <- readxl::read_excel("C:/Users/joelm/OneDrive/Escritorio/Proy/Drugs/drugInvolvementSouth Carolina/Offenses_Involving_Offender's_Suspected_Use_Drugs_Narcotics_and_Alcohol_by_Offense_Category_2022.xlsx")
south_carolina <- as.data.frame(south_carolina)

south_carolina <- south_carolina[-c(1:4), ]
num_filas <- nrow(south_carolina)
south_carolina <- south_carolina[-num_filas, ]
south_carolina$estado <- "South Carolina"

colnames(south_carolina) <- colnames(drugs)
drugs <- rbind(drugs, south_carolina)


# South_Dakota
south_dakota <- readxl::read_excel("C:/Users/joelm/OneDrive/Escritorio/Proy/Drugs/drugInvolvementSouth Dakota/Offenses_Involving_Offender's_Suspected_Use_Drugs_Narcotics_and_Alcohol_by_Offense_Category_2022.xlsx")
south_dakota <- as.data.frame(south_dakota)

south_dakota <- south_dakota[-c(1:4), ]
num_filas <- nrow(south_dakota)
south_dakota <- south_dakota[-num_filas, ]
south_dakota$estado <- "South Dakota"

colnames(south_dakota) <- colnames(drugs)
drugs <- rbind(drugs, south_dakota)


# Tennessee
tennessee <- readxl::read_excel("C:/Users/joelm/OneDrive/Escritorio/Proy/Drugs/drugInvolvementTennessee/Offenses_Involving_Offender's_Suspected_Use_Drugs_Narcotics_and_Alcohol_by_Offense_Category_2022.xlsx")
tennessee <- as.data.frame(tennessee)

tennessee <- tennessee[-c(1:4), ]
num_filas <- nrow(tennessee)
tennessee <- tennessee[-num_filas, ]
tennessee$estado <- "Tennessee"

colnames(tennessee) <- colnames(drugs)
drugs <- rbind(drugs, tennessee)


# Texas
texas <- readxl::read_excel("C:/Users/joelm/OneDrive/Escritorio/Proy/Drugs/drugInvolvementTexas/Offenses_Involving_Offender's_Suspected_Use_Drugs_Narcotics_and_Alcohol_by_Offense_Category_2022.xlsx")
texas <- as.data.frame(texas)

texas <- texas[-c(1:4), ]
num_filas <- nrow(texas)
texas <- texas[-num_filas, ]
texas$estado <- "Texas"

colnames(texas) <- colnames(drugs)
drugs <- rbind(drugs, texas)


# Utah
utah <- readxl::read_excel("C:/Users/joelm/OneDrive/Escritorio/Proy/Drugs/drugInvolvementUtah/Offenses_Involving_Offender's_Suspected_Use_Drugs_Narcotics_and_Alcohol_by_Offense_Category_2022.xlsx")
utah <- as.data.frame(utah)

utah <- utah[-c(1:4), ]
num_filas <- nrow(utah)
utah <- utah[-num_filas, ]
utah$estado <- "Utah"

colnames(utah) <- colnames(drugs)
drugs <- rbind(drugs, utah)


# Vermont
vermont <- readxl::read_excel("C:/Users/joelm/OneDrive/Escritorio/Proy/Drugs/drugInvolvementVermont/Offenses_Involving_Offender's_Suspected_Use_Drugs_Narcotics_and_Alcohol_by_Offense_Category_2022.xlsx")
vermont <- as.data.frame(vermont)

vermont <- vermont[-c(1:4), ]
num_filas <- nrow(vermont)
vermont <- vermont[-num_filas, ]
vermont$estado <- "Vermont"

colnames(vermont) <- colnames(drugs)
drugs <- rbind(drugs, vermont)


# Virginia
virginia <- readxl::read_excel("C:/Users/joelm/OneDrive/Escritorio/Proy/Drugs/drugInvolvementVirginia/Offenses_Involving_Offender's_Suspected_Use_Drugs_Narcotics_and_Alcohol_by_Offense_Category_2022.xlsx")
virginia <- as.data.frame(virginia)

virginia <- virginia[-c(1:4), ]
num_filas <- nrow(virginia)
virginia <- virginia[-num_filas, ]
virginia$estado <- "Virginia"

colnames(virginia) <- colnames(drugs)
drugs <- rbind(drugs, virginia)


# Washington
washington <- readxl::read_excel("C:/Users/joelm/OneDrive/Escritorio/Proy/Drugs/drugInvolvementWashington/Offenses_Involving_Offender's_Suspected_Use_Drugs_Narcotics_and_Alcohol_by_Offense_Category_2022.xlsx")
washington <- as.data.frame(washington)

washington <- washington[-c(1:4), ]
num_filas <- nrow(washington)
washington <- washington[-num_filas, ]
washington$estado <- "Washington"

colnames(washington) <- colnames(drugs)
drugs <- rbind(drugs, washington)


# West Virginia
west_virginia <- readxl::read_excel("C:/Users/joelm/OneDrive/Escritorio/Proy/Drugs/drugInvolvementWest Virginia/Offenses_Involving_Offender's_Suspected_Use_Drugs_Narcotics_and_Alcohol_by_Offense_Category_2022.xlsx")
west_virginia <- as.data.frame(west_virginia)

west_virginia <- west_virginia[-c(1:4), ]
num_filas <- nrow(west_virginia)
west_virginia <- west_virginia[-num_filas, ]
west_virginia$estado <- "West Virginia"

colnames(west_virginia) <- colnames(drugs)
drugs <- rbind(drugs, west_virginia)


# Wisconsin
wisconsin <- readxl::read_excel("C:/Users/joelm/OneDrive/Escritorio/Proy/Drugs/drugInvolvementWisconsin/Offenses_Involving_Offender's_Suspected_Use_Drugs_Narcotics_and_Alcohol_by_Offense_Category_2022.xlsx")
wisconsin <- as.data.frame(wisconsin)

wisconsin <- wisconsin[-c(1:4), ]
num_filas <- nrow(wisconsin)
wisconsin <- wisconsin[-num_filas, ]
wisconsin$estado <- "Wisconsin"

colnames(wisconsin) <- colnames(drugs)
drugs <- rbind(drugs, wisconsin)


# Wyoming
wyoming <- readxl::read_excel("C:/Users/joelm/OneDrive/Escritorio/Proy/Drugs/drugInvolvementWyoming/Offenses_Involving_Offender's_Suspected_Use_Drugs_Narcotics_and_Alcohol_by_Offense_Category_2022.xlsx")
wyoming <- as.data.frame(wyoming)

wyoming <- wyoming[-c(1:4), ]
num_filas <- nrow(wyoming)
wyoming <- wyoming[-num_filas, ]
wyoming$estado <- "Wyoming"

colnames(wyoming) <- colnames(drugs)
drugs <- rbind(drugs, wyoming)

# Wyoming
wyoming <- readxl::read_excel("C:/Users/joelm/OneDrive/Escritorio/Proy/Drugs/drugInvolvementWyoming/Offenses_Involving_Offender's_Suspected_Use_Drugs_Narcotics_and_Alcohol_by_Offense_Category_2022.xlsx")
wyoming <- as.data.frame(wyoming)

wyoming <- wyoming[-c(1:4), ]
num_filas <- nrow(wyoming)
wyoming <- wyoming[-num_filas, ]
wyoming$estado <- "Wyoming"

colnames(wyoming) <- colnames(drugs)
drugs <- rbind(drugs, wyoming)

# U.S._Virgin_Islands
u.s._virgin_islands <- readxl::read_excel("C:/Users/joelm/OneDrive/Escritorio/Proy/Drugs/drugInvolvementU.S. Virgin Islands/Offenses_Involving_Offender's_Suspected_Use_Drugs_Narcotics_and_Alcohol_by_Offense_Category_2022.xlsx")
u.s._virgin_islands <- as.data.frame(u.s._virgin_islands)

u.s._virgin_islands <- u.s._virgin_islands[-c(1:4), ]
num_filas <- nrow(u.s._virgin_islands)
u.s._virgin_islands <- u.s._virgin_islands[-num_filas, ]
u.s._virgin_islands$estado <- "U.S. Virgin Islands"

colnames(u.s._virgin_islands) <- colnames(drugs)
drugs <- rbind(drugs, u.s._virgin_islands)


# Puerto_Rico
puerto_rico <- readxl::read_excel("C:/Users/joelm/OneDrive/Escritorio/Proy/Drugs/drugInvolvementPuerto Rico/Offenses_Involving_Offender's_Suspected_Use_Drugs_Narcotics_and_Alcohol_by_Offense_Category_2022.xlsx")
puerto_rico <- as.data.frame(puerto_rico)

puerto_rico <- puerto_rico[-c(1:4), ]
num_filas <- nrow(puerto_rico)
puerto_rico <- puerto_rico[-num_filas, ]
puerto_rico$estado <- "Puerto Rico"

colnames(puerto_rico) <- colnames(drugs)
drugs <- rbind(drugs, puerto_rico)

# Indiana
indiana <- readxl::read_excel("C:/Users/joelm/OneDrive/Escritorio/Proy/Drugs/drugInvolvementIndiana/Offenses_Involving_Offender's_Suspected_Use_Drugs_Narcotics_and_Alcohol_by_Offense_Category_2022.xlsx")
indiana <- as.data.frame(indiana)

indiana <- indiana[-c(1:4), ]
num_filas <- nrow(indiana)
indiana <- indiana[-num_filas, ]
indiana$estado <- "Indiana"

colnames(indiana) <- colnames(drugs)
drugs <- rbind(drugs, indiana)


# Guam
guam <- readxl::read_excel("C:/Users/joelm/OneDrive/Escritorio/Proy/Drugs/drugInvolvementGuam/Offenses_Involving_Offender's_Suspected_Use_Drugs_Narcotics_and_Alcohol_by_Offense_Category_2022.xlsx")
guam <- as.data.frame(guam)

guam <- guam[-c(1:4), ]
num_filas <- nrow(guam)
guam <- guam[-num_filas, ]
guam$estado <- "Guam"

colnames(guam) <- colnames(drugs)
drugs <- rbind(drugs, guam)


# American_Samoa
american_samoa <- readxl::read_excel("C:/Users/joelm/OneDrive/Escritorio/Proy/Drugs/drugInvolvementAmerican Samoa/Offenses_Involving_Offender's_Suspected_Use_Drugs_Narcotics_and_Alcohol_by_Offense_Category_2022.xlsx")
american_samoa <- as.data.frame(american_samoa)

american_samoa <- american_samoa[-c(1:4), ]
num_filas <- nrow(american_samoa)
american_samoa <- american_samoa[-num_filas, ]
american_samoa$estado <- "American Samoa"

colnames(american_samoa) <- colnames(drugs)
drugs <- rbind(drugs, american_samoa)


# Marina_Islands
marina_islands <- readxl::read_excel("C:/Users/joelm/OneDrive/Escritorio/Proy/Drugs/drugInvolvementMarina Islands/Offenses_Involving_Offender's_Suspected_Use_Drugs_Narcotics_and_Alcohol_by_Offense_Category_2022.xlsx")
marina_islands <- as.data.frame(marina_islands)

marina_islands <- marina_islands[-c(1:4), ]
num_filas <- nrow(marina_islands)
marina_islands <- marina_islands[-num_filas, ]
marina_islands$estado <- "Marina Islands"

colnames(marina_islands) <- colnames(drugs)
drugs <- rbind(drugs, marina_islands)


# Imprimir el data frame para verificar
print(drugs)


valores_unicos <- unique(drugs$Estado)
num_valores_unicos <- length(valores_unicos)
num_valores_unicos

# Imprimir el resultado
print(num_valores_unicos)
valores_unicos

drugs <- subset(drugs, !(Estado %in% c('Puerto_Rico', 'U.S._Virgin_Islands')))


drugs$`Percentage of Offense Category` <- as.numeric(drugs$`Percentage of Offense Category`)
drugs$`Percentage of Offense Category` <- drugs$`Percentage of Offense Category` * 100
drugs$`Percentage of Offense Category` <- round(drugs$`Percentage of Offense Category`, digits = 2)
drugs$`Percentage of Offense Category` <- sprintf("%.2f", drugs$`Percentage of Offense Category`)

drugs$`Percentage of Offense category` <- as.numeric(drugs$`Percentage of Offense category`)
drugs$`Percentage of Offense category` <- drugs$`Percentage of Offense category` * 100
drugs$`Percentage of Offense category` <- round(drugs$`Percentage of Offense category`, digits = 2)
drugs$`Percentage of Offense category` <- sprintf("%.2f", drugs$`Percentage of Offense category`)



ruta_archivo <- "C:/Users/joelm/OneDrive/Escritorio/Drugs.csv"
write.csv(drugs, file = ruta_archivo, row.names = FALSE)
